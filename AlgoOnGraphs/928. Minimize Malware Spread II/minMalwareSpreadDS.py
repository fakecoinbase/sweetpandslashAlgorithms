class Solution:
    def minMalwareSpread(self, graph: List[List[int]], initial: List[int]) -> int:
        if not graph: return -1
        N = len(graph)
        clean = set(range(N)) - set(initial)
        
        def dfs(u, seen):
            for v, adj in enumerate(graph[u]):
                if adj and v in clean and v not in seen:
                    seen.add(v)
                    dfs(v, seen)
                    
        d = collections.defaultdict(list)
        for u in initial:
            seen = set()
            dfs(u, seen)
            
            for v in seen:
                d[v].append(u)
                
        count = [0] * N
        for v, infects in d.items():
            if len(infects) == 1:
                count[infects[0]] += 1
        
        return count.index(max(count)) if max(count) != 0 else min(initial)
