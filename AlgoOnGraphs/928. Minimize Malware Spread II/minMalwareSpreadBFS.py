class Solution:
    def minMalwareSpread(self, graph: List[List[int]], initial: List[int]) -> int:
        if not graph: return -1
        N = len(graph)
        clean = set(range(N)) - set(initial)
        d = collections.defaultdict(list)

        for u in initial:
            Q = collections.deque([u])
            seen = set(initial)
            while Q:
                infect = Q.popleft()
                for v, adj in enumerate(graph[infect]):
                    if adj and v not in seen and v in clean:
                        seen.add(v)
                        Q.append(v)
                        d[v].append(u)
        
        count = [0] * N
        for v, infects in d.items():
            if len(infects) == 1:
                count[infects[0]] += 1
        maxi = max(count)
        return count.index(maxi) if maxi != 0 else min(initial)
