class Solution:
    def minMalwareSpread(self, graph: List[List[int]], initial: List[int]) -> int:
        n = len(graph)
        counts = {}
        reachable = {}
        initial = set(initial)
        def dfs(i, pre = None):
            hit = i in initial
            if hit: pre = i
            reachable[i] = pre
            ans = 0 if hit else 1
            
            for j in range(n):
                if graph[i][j] == 0: continue
                if j in reachable and reachable[j] != pre: hit = True
                if j in reachable: continue
                curr = dfs(j, pre)
                if curr > 0:
                    ans += curr
                else: 
                    hit = True
            if i in initial:
                counts[i] = ans
            return ans if not hit else 0
        for i in initial:
            if i in reachable: continue
            dfs(i, i)
        return min((-v, k) for (k, v) in counts.items())[1]
